<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Q&A</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
   
</head>
<body>
    <header>
        <h1>BronxBot Data Gifts</h1>
    </header>

    <main>
    <div id="question">Loading question...</div>
    <div class="input-container">
        <textarea placeholder="Enter your answer" id="text-input"></textarea>
        <input type="file" id="file-input" accept="image/*,video/*,audio/*">
        <div>
            <label><input type="checkbox" name="file-type" value="text"> Text</label>
            <label><input type="checkbox" name="file-type" value="video"> Video</label>
            <label><input type="checkbox" name="file-type" value="audio"> Audio</label>
            <label><input type="checkbox" name="file-type" value="image"> Image</label>
        </div>
        <button id="submit-button">Submit Answer</button>
        <button id="next-button">Next Question</button>
    </div>

    <script>
        const colors = ["#3c1518", "#487a78", "#487a78", "#D24839", "#8e5920"];
        let currentQuestion = "";

        async function fetchQuestion() {
            try {
                const response = await fetch('/api/question?lang=en');
                const data = await response.json();
                currentQuestion = data.question;
                document.getElementById('question').textContent = currentQuestion;
                document.body.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            } catch (error) {
                console.error('Error fetching question:', error);
            }
        }

        async function submitAnswer() {
            const textInput = document.getElementById('text-input').value;
            const fileInput = document.getElementById('file-input').files[0];
            const fileType = document.querySelector('input[name="file-type"]:checked').value;

            if (!textInput && !fileInput) {
                alert('Please enter an answer or upload a file before submitting.');
                return;
            }

            const formData = new FormData();
            formData.append('answer', textInput);
            formData.append('file', fileInput);
            formData.append('file_type', fileType);

            try {
                const response = await fetch('/api/answer', {
                    method: 'POST',
                    body: formData,
                });
                const data = await response.json();
                alert('Your answer has been successfully submitted!');
            } catch (error) {
                console.error('Error submitting answer:', error);
            }
        }

        document.getElementById('submit-button').addEventListener('click', submitAnswer);
        document.getElementById('next-button').addEventListener('click', fetchQuestion);

        fetchQuestion();
    </script>
</main>

    <footer>
        <p>No personal information is being collected with your contribution unless you add it in your text.<br>
            &copy; 2025 BronxBot Data. All Rights Reserved.</p>
    </footer>
</body>
</html>