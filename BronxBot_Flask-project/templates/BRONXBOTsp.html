<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BronxBot en Español</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
   
</head>
<body>
    <div id="question">Cargando pregunta...</div>
    <div class="input-container">
        <textarea placeholder="Escribe tu respuesta" id="text-input"></textarea>
        <input type="file" id="file-input" accept="image/*,video/*,audio/*">
        <div>
            <label><input type="checkbox" name="file-type" value="text"> Texto</label>
            <label><input type="checkbox" name="file-type" value="video"> Video</label>
            <label><input type="checkbox" name="file-type" value="audio"> Audio</label>
            <label><input type="checkbox" name="file-type" value="image"> Imagen</label>
        </div>
        <button id="submit-button">Enviar Respuesta</button>
        <button id="next-button">Siguiente Pregunta</button>
    </div>

    <script>
        const colors = ["#3c1518", "#487a78", "#487a78", "#D24839", "#8e5920", "#304d74"];
        let currentQuestion = "";

        async function fetchQuestion() {
            try {
                const response = await fetch('/api/question?lang=es');
                const data = await response.json();
                currentQuestion = data.question;
                document.getElementById('question').textContent = currentQuestion;
                document.body.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            } catch (error) {
                console.error('Error fetching question:', error);
            }
        }

        async function submitAnswer() {
            const textInput = document.getElementById('text-input').value;
            const fileInput = document.getElementById('file-input').files[0];
            const fileType = document.querySelector('input[name="file-type"]:checked').value;

            if (!textInput && !fileInput) {
                alert('Por favor, escribe una respuesta o sube un archivo antes de enviar.');
                return;
            }

            const formData = new FormData();
            formData.append('answer', textInput);
            formData.append('file', fileInput);
            formData.append('file_type', fileType);

            try {
                const response = await fetch('/api/answer', {
                    method: 'POST',
                    body: formData,
                });
                const data = await response.json();
                alert('¡Tu respuesta ha sido enviada con éxito!');
            } catch (error) {
                console.error('Error al enviar la respuesta:', error);
            }
        }

        document.getElementById('submit-button').addEventListener('click', submitAnswer);
        document.getElementById('next-button').addEventListener('click', fetchQuestion);

        fetchQuestion();
    </script>
</body>
</html>